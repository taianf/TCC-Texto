%% Carrega a classe "mestrado"
%% Opções: bsc - para monografias de graduação
%%         msc - (padrão) para dissertações de mestrado
%%         phd - para teses de doutorado
\documentclass[msc]{mestrado}
%% Preâmbulo:
%% coloque aqui o seu preâmbulo LaTeX, i.e., declaração de pacotes,
%% (re)definições de macros, medidas, etc.

%\usepackage[pdftex]{graphicx, color}
%\usepackage{graphicx, color}

\usepackage[T1]{fontenc}

%%% caracteres acentuados em ISO-8859-1
\usepackage[latin1]{inputenc}

%%% Suporte para gerar o documento em Português e Inglês
\usepackage[brazil]{babel}

%%% indenta primeiro parágrafo, estilo brasileiro.
%\usepackage{indentfirst}
\usepackage{setspace}
\usepackage{calc}
\usepackage{xspace}



\usepackage[alf]{abntcite}



%\usepackage{latex8}
\usepackage{times}
\usepackage{graphicx,url}
\usepackage{url}
\usepackage{color}
\usepackage{epsfig}



%\usepackage[pdftex]{graphicx}
%\usepackage{color}
%\usepackage{graphics}
%\usepackage{epsfig}

%\usepackage{savesym}
%\usepackage{tlatex}
%\savesymbol{implies}
%\usepackage{amsmath}
%\restoresymbol{TXF}{implies}

\usepackage{amssymb, bm}
\usepackage{verbatim}
\usepackage{underscore}

\usepackage{savesym}
\usepackage{mytlatex}
\savesymbol{implies}
\usepackage{amsmath}

\newcommand{\doris}{\emph{DoRiS}}
\newcommand{\act}[1]{\vspace{0.10cm} $\bullet \,$ \textbf{\emph{#1}} $\, -$}
\newcommand{\cod}[1]{\verbatim{#1}}

%\newcommand{\HRT}{\emph{Hard Real Time}}
%\newcommand{\BE}{\emph{Best Effort}}

\newcommand{\RTS}{\mathcal{R^H}}
\newcommand{\SOS}{\mathcal{R^S}}
\newcommand{\DS}{DS}
\newcommand{\HW}{\mathcal{W}^H}
\newcommand{\ES}{\mathcal{S}^E}
\newcommand{\RS}{\mathcal{S}^R}
\newcommand{\SW}{\mathcal{W}^S}
\newcommand{\DDC}{\Delta}
\newcommand{\DHW}{\Delta^H}
\newcommand{\DSW}{\Delta^S}
\newcommand{\DES}{\Delta^E}
%\newcommand{\DRS}{\Delta^R}
%\newcommand{\defeq}{\triangleq}

\newcommand{\parspace}{\par \vspace{0.3cm}}
%\renewcommand{\parspace}{\par \vspace{0.3cm}}
\newcommand{\spaceTab}{\vspace{0.1cm} \\}
%\renewcommand{\parspace}{\par \vspace{0.3cm}}
\newcommand{\iniTabSpc}{\vspace{0.2cm} \begin{center}
                        \begin{itshape} \begin{spacing}{1.}}
\newcommand{\fimTabSpc}{\end{spacing} \end{itshape}
                        \end{center} \vspace{-0.2cm} }


%% Inicio do documento
\begin{document}
\mainmatter

\headsep=40pt
\oddsidemargin=15pt
\begin{spacing}{1.4}
\parskip=6pt

\chapter{A disciplina RTnet \emph{DoRiS}}
\label{cap:}

\section{Inicialização}
\label{sec:}

\subsection{O Módulo \texttt{doris_module.c}}

No arquivo \texttt{doris_module.c}, o módulo \doris{} é inicializado.
A estrutura \texttt{rtmac_disc} é instanciada para definir a disciplina
\texttt{doris_disc}. Esta estrutura define principalmente os nomes das
funções da disciplina.

As duas funções \texttt{doris_attach} e
\texttt{doris_detach} são definidas servem a ativar e desativar 
\emph{DoRiS} uma vez o dispositivo da placa de rede carregado.
Elas são definidas neste mesmo arquivo.
Isto será visto mais a frente ???

As funções de transmissão e recepção, chamadas
\texttt{doris_packet_rx}, \texttt{doris_rt_packet_rx} e
\texttt{doris_nrt_packet_rx}, são definidas no arquivo
\texttt{doris_proto.c}.


O processo de inicialização executa duas rotinas:
\texttt{doris_proto_init} e \texttt{rtmac_disc_register} e retorna.


\begin{itemize}
\item[] \act{\texttt{doris_proto_init}} Esta função é definida no
  arquivo \texttt{doris_proto.c} e realiza as operações seguintes:
  \begin{itemize}
  \item Inicializa a fila \texttt{nrt_rtskb_queue} de memórias
    tampões do tipo \texttt{rtskb} para a comunicação de melhor
    esforço.
  \item Inicializa um canal de eventos \texttt{wakeup_sem}.
  \item Inicializa a tarefa de tempo real \texttt{wrapper_task}, com a
    menor prioridade, que executa a função \texttt{nrt_xmit_task}.
  \end{itemize}
\end{itemize}


A função \texttt{nrt_xmit_task} é constituída de um laço
\texttt{while} sem fim que é habilitado quando um evento é sinalizado
através da variável \texttt{wakeup_sem}. Nesta ocorrência, a função
transmite os pacotes (\texttt{rtskb}) enfileirados na fila
\texttt{nrt_rtskb_queue} , usando a função \texttt{rtmac_xmit}, quando
estiver em possessão do \texttt{lock xmit_mutex} .
A função \texttt{rtmac_xmit} instância a estrutura
\texttt{rtnet_device} referenciada pelo pacote (\texttt{rtskb}) e
utiliza a função \texttt{hard_start_xmit} definida por um campo desta
estrutura para transmitir o pacote. Esta função depende do hardware e
é definida no controlador da placa de rede.

\begin{itemize}
\item[] \act{\texttt{rtmac_disc_register}} Esta função, definida no
  arquivo \texttt{rtmac_disc.c}, registra a disciplina, isto é:
  \begin{itemize}
  \item Verifique que os elementos necessários são definidos.
  \item Registra as funções \texttt{ioctls} que implementam a
    interface de controle disponibilizada para os usuários.
  \end{itemize}
\end{itemize}

O campo \texttt{ioctls} da estrutura \texttt{doris_disc} 
recebe o nome da função de interface \texttt{doris_ioctl} que serve
de wrapper para acessar as funções de controle definidas
 no arquivo \texttt{doris_ioctl.c}.



A estrutura \texttt{doris_priv} contem dois campos principais:
\begin{itemize}
\item Uma estrutura \texttt{rtnet_device} que corresponde ao
  dispositivo de controle da placa de rede (\texttt{rteth0})
\item Uma estrutura \texttt{rtdm_device} que contem as funções que a
  disciplina \doris{} oferece como API aos usuários.
\end{itemize}



   no arquivo \texttt{rtmac_proto.h}.
Ela 
\texttt{rtmac_disc_register}

% Apêndices
% Comente se não houver apêndices

%%%\appendix

% É aconselhável criar cada apêndice em um arquivo à parte, digamos
% "apendice1.tex", "apendice.tex", ... "apendiceM.tex" e depois
% incluí-los com:

%%%\include{tex/algoritmo}

% \include{apendice1}
% \include{apendice2}
% ...
% \include{apendiceM}



\end{spacing}

%%
%% Parte pós-textual
%%
\backmatter

% Bibliografia
% É aconselhável utilizar o BibTeX a partir de um arquivo, digamos "biblio.bib".
% Para ajuda na criação do arquivo .bib e utilização do BibTeX, recorra ao
% BibTeXpress em www.cin.ufpe.br/~paguso/bibtexpress
%%%\renewcommand{\bibname}{REFERÊNCIAS}
%\nocite{*}
%\bibliographystyle{authordate2}
%\bibliographystyle{abnt-alf}

%%%\bibliography{tex/bib}

%% Fim do documento
\end{document}
